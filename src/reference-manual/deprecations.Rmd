# Deprecated Features

This appendix lists currently deprecated functionality along with how
to replace it.

Starting with Stan 2.29, minor (syntax-level) deprecations can be removed 3
versions after release; e.g., syntax deprecated in Stan 2.20 will be removed in
Stan 2.23 and placed in [Removed Features]. The Stan compiler can
[automatically update](https://mc-stan.org/docs/stan-users-guide/stanc-pretty-printing.html)
many of these on the behalf of the user for at least one version after they are
removed.

Any feature which changes semantic meaning (such as the upgraded ODE solver
interface) will not be removed until a major version change (e.g., Stan 3.0).


## `lkj_cov` distribution

*Deprecated*:The distribution `lkj_cov` is deprecated.

*Replacement*: Replace `lkj_cov_lpdf(...)` with an `lkj_corr`
  distribution on the correlation matrix and independent lognormal
  distributions on the scales.  That is, replace

```stan
cov_matrix[K] Sigma;
// ...
Sigma ~ lkj_cov(mu, tau, eta);
```

with

```stan
corr_matrix[K] Omega;
vector<lower=0>[K] sigma;
// ...
Omega ~ lkj_corr(eta);
sigma ~ lognormal(mu, tau);
// ...
cov_matrix[K] Sigma;
Sigma <- quad_form_diag(Omega, sigma);
```

The variable `Sigma` may be defined as a local variable in the model
block or as a transformed parameter.  An even more efficient transform
would use Cholesky factors rather than full correlation matrix types.


*Scheduled Removal*: Stan 3.0 or later.

## Real values in conditionals

*Deprecated*: Using a real value in a conditional
```stan
real x = 1.0;
if (x) {
```
The value is interpreted as true if it is nonzero.

*Replacement*: For the exact equivalent, use a comparison operator to make the intent clear.
```stan
real x = 1.0;
if (x != 0) {
```
However, one should keep in mind that floating point calculations are subject to rounding errors
and precise equality is fragile. It is worth considering whether the more robust alternative
`abs(x) < machine_precision()` is appropriate for the use case.

*Scheduled Removal*: Stan 2.34


## Deprecated Functions

Several built-in Stan functions have been deprecated. Consult the
[functions reference](https://mc-stan.org/docs/functions-reference/deprecated-functions.html)
for more information.
